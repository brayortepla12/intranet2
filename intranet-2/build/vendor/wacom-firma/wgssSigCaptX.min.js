var JSONreq={map:{},counter:0,getJSON:function(t,e,n){var s=t+(t.indexOf("?")+1?"&":"?"),i=document.getElementsByTagName("head")[0],a=document.createElement("script"),o=[],r="",c="json-"+this.counter;for(r in this.counter++,e.script_name=c,e._rand=Math.random(),this.map[c]=n,e.callback="JSONreq.success",e)o.push(r+"="+encodeURIComponent(e[r]));s+=o.join("&"),a.type="text/javascript",a.src=s,a.id=c,i.appendChild(a)},success:function(t){var e=t.script_name;delete t.script_name,this.map[e](t);var n=document.getElementsByTagName("head")[0],s=document.getElementById(e);n.removeChild(s),delete this.map.script_name}};function WacomGSS_SignatureSDK(t,e){this.running=!1,this.session=null,this.service_detected=!1;var n=this,s="https://localhost:";function i(e){0==e.status?(n.session=e.session,n.running=!0,t()):console.log("Signature SDK local server error: "+e.status)}function a(t){if(0==t.status){n.service_detected=!0,s+=t.port+"/";JSONreq.getJSON(s+"wacom.js",{CreateSession:1},i)}else console.log("Signature SDK Service error: "+t.status)}function r(t){return void 0===t||null==t?"":t}this.RBFlags={RenderOutputPicture:2097152,RenderOutputBase64:8192,RenderBackgroundTransparent:65536,RenderColor1BPP:131072,RenderColor24BPP:262144,RenderColor32BPP:524288,RenderColorAntiAlias:1048576,RenderEncodeData:4194304,RenderWatermark:8388608,RenderClipped:16777216,RenderRelative:33554432},this.IntegrityStatus={IntegrityOK:0,IntegrityFail:1,IntegrityMissing:2,IntegrityWrongType:3,IntegrityInsufficientData:4,IntegrityUncertain:5,IntegrityUnsupported:6},this.HashType={HashNone:0,HashMD5:1,HashSHA1:2,HashSHA224:3,HashSHA256:4,HashSHA384:5,HashSHA512:6},this.KeyType={KeyNone:0,KeyMD5:1,KeyMD5MAC:2,KeySHA1:3,KeySHA224:4,KeySHA256:5,KeySHA384:6,KeySHA512:7,KeyCAPICOM:8},this.SignedData={DataGood:0,DataNoHash:1,DataBadType:2,DataBadHash:3,DataError:4,DataUncertain:5,DataSigMoved:6},this.CaptData={CaptDigitizer:26,CaptDigitizerDriver:27,CaptMachineOS:28,CaptNetworkCard:29},this.DynamicCaptureResult={DynCaptOK:0,DynCaptCancel:1,DynCaptPadError:100,DynCaptError:101,DynCaptNotLicensed:103,DynCaptAbort:200,DynCaptIntegrityKeyInvalid:102},this.TimeZone={TimeLocal:0,TimeGMT:1,TimeUTC:1},this.DisplayMode={DspForceFit:0,DspUseZoom:1,DspBestFit:2},this.ShowText={TxtDontShow:0,TxtShowLeft:1,TxtShowCenter:2,TxtShowRight:4},this.ObjectType={ObjectText:0,ObjectButton:1,ObjectCheckbox:2,ObjectSignature:3,ObjectInput:4,ObjectInputEcho:5,ObjectHash:6,ObjectImage:7,ObjectDisplayAtShutdown:8,ObjectInking:9,ObjectRadioButton:10},this.TextOptions={TextAlignLeft:0,TextAlignRight:1,TextAlignCentre:2,TextAlignJustify:3},this.ButtonOptions={BtnAlignCentre:0,BtnAlignMiddle:0,BtnAlignLeft:1,BtnAlignRight:2,BtnAlignTop:4,BtnAlignBottom:8},this.CheckBoxOptions={CheckboxUnchecked:0,CheckboxChecked:1,CheckboxDisplayTick:2,CheckboxDisplayCross:4},this.ObjectOptionType={OBJECTOPTION_STRING:0,OBJECTOPTION_INT:1,OBJECTOPTION_BOOL:2},this.VariantType={VARIANT_EMPTY:0,VARIANT_TEXT:1,VARIANT_NUM:2,VARIANT_OBJECTOPTIONS:3,VARIANT_SIGOBJ:4,VARIANT_SIGCTL:5,VARIANT_INPUTOBJ:6,VARIANT_HASH:7,VARIANT_IMGURL:8,VARIANT_BASE64:9,VARIANT_DYNCAP:10,VARIANT_WIZCTL:11,VARIANT_FONT:12,VARIANT_KEY:13},this.PrimitiveType={PrimitiveLine:0,PrimitiveRectangle:1,PrimitiveEllipse:2},this.PrimitiveOptions={PrimitiveLineSolid:1,PrimitiveLineDashed:2,PrimitiveOutline:4,PrimitiveFill:8,PrimitiveFillXOR:16},this.EventType={EvTextClicked:0,EvButtonClicked:1,EvCheckboxChecked:2,EvCheckboxUnchecked:3,EvInputMinReached:4,EvInputMaxReached:5,EvInputExceeded:6},this.EncryptAlg={EncryptNone:0,EncryptTripleDES:1},this.ResponseStatus={OK:0,FAILED:1,INVALID_SESSION:3},this.FontWeight={FW_DONTCARE:0,FW_THIN:100,FW_EXTRALIGHT:200,FW_LIGHT:300,FW_NORMAL:400,FW_MEDIUM:500,FW_SEMIBOLD:600,FW_BOLD:700,FW_EXTRABOLD:800,FW_HEAVY:900,FW_ULTRALIGHT:200,FW_REGULAR:400,FW_DEMIBOLD:600,FW_ULTRABOLD:800,FW_BLACK:900},this.FontCharset={ANSI_CHARSET:0,DEFAULT_CHARSET:1,SYMBOL_CHARSET:2,SHIFTJIS_CHARSET:128,HANGEUL_CHARSET:129,HANGUL_CHARSET:129,GB2312_CHARSET:134,CHINESEBIG5_CHARSET:136,OEM_CHARSET:255,JOHAB_CHARSET:130,HEBREW_CHARSET:177,ARABIC_CHARSET:178,GREEK_CHARSET:161,TURKISH_CHARSET:162,VIETNAMESE_CHARSET:163,THAI_CHARSET:222,EASTEUROPE_CHARSET:238,RUSSIAN_CHARSET:204,MAC_CHARSET:77,BALTIC_CHARSET:186,FS_LATIN1:1,FS_LATIN2:2,FS_CYRILLIC:4,FS_GREEK:8,FS_TURKISH:16,FS_HEBREW:32,FS_ARABIC:64,FS_BALTIC:128,FS_VIETNAMESE:256,FS_THAI:65536,FS_JISJAPAN:131072,FS_CHINESESIMP:262144,FS_WANSUNG:524288,FS_CHINESETRAD:1048576,FS_JOHAB:2097152,FS_SYMBOL:2147483648},this.Font=function(t,e,s,i,a,o,r){this.type=n.VariantType.VARIANT_FONT,this.fontName=void 0===t?"Arial":t,this.fontSize=void 0===e?8:e,this.sWeight=void 0===s?n.FontWeight.FW_NORMAL:s,this.sCharset=void 0===i?n.FontCharset.ANSI_CHARSET:i,this.fItalic="undefined"==typeof fItalic?0:fItalic,this.fUnderline=void 0===o?0:fUnderline,this.fStrikethrough=void 0===r?0:r},JSONreq.getJSON(s+e+"/wacom.js",{GetPort:1},a),this.getVersion=function(t){var e={GetVersion:1,session:n.session};JSONreq.getJSON(s+"wacom.js",e,function(e){t(e.version,parseInt(e.status))})},this.Hash=function(t){var e=this;this.handle=null,this.type=n.VariantType.VARIANT_HASH;var i={Hash:"Constructor",session:n.session};JSONreq.getJSON(s+"wacom.js",i,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.Add=function(t,i){var a={Hash:"Add",session:n.session,handle:e.handle};t.Stringify(a,"hData"),JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.Clear=function(t){var i={Hash:"Clear",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.GetType=function(t){var i={Hash:"GetType",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.hashType),parseInt(n.status))})},this.PutType=function(t,i){var a={Hash:"PutType",session:n.session,handle:e.handle,type:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})}},this.Key=function(t){var e=this;this.handle=null,this.type=n.VariantType.VARIANT_KEY;var i={Key:"Constructor",session:n.session};JSONreq.getJSON(s+"wacom.js",i,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.GetType=function(t){var i={Key:"GetType",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.type),parseInt(n.status))})},this.Set=function(t,i,a){var o={Key:"Set",session:n.session,handle:e.handle,type:r(t)};i.Stringify(o,"value"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})}},this.Bitmap=function(){this.handle=null,this.isBase64=!1,this.mime_type=null,this.image=new Image},this.SigObj=function(){var t=this;this.handle=null,this.type=n.VariantType.VARIANT_SIGOBJ,this.CheckIntegrity=function(e,i){var a={SigObj:"CheckIntegrity",session:n.session,handle:t.handle},o=new n.Variant;o.Set(e),o.Stringify(a,"key"),JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.CheckSignedData=function(e,i){var a={SigObj:"CheckSignedData",session:n.session,handle:t.handle,HashHandle:r(e.handle)};JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.Clear=function(e){var i={SigObj:"Clear",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,parseInt(n.status))})},this.GetAdditionalData=function(e,i){var a={SigObj:"GetAdditionalData",session:n.session,handle:t.handle,captData:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,e.additionalData,parseInt(e.status))})},this.GetCrossedOut=function(e){var i={SigObj:"GetCrossedOut",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,Boolean(1==parseInt(n.crossedOut)),parseInt(n.status))})},this.GetExtraData=function(e,i){var a={SigObj:"GetExtraData",session:n.session,handle:t.handle,key:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,e.extraData,parseInt(e.status))})},this.GetHeight=function(e){var i={SigObj:"GetHeight",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,parseInt(n.height),parseInt(n.status))})},this.GetInk=function(e){var i={SigObj:"GetInk",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,n.ink,parseInt(n.status))})},this.GetIsCaptured=function(e){var i={SigObj:"GetIsCaptured",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,Boolean(1==parseInt(n.isCaptured)),parseInt(n.status))})},this.GetProperty=function(e,i){var a={SigObj:"GetProperty",session:n.session,handle:t.handle,key:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){var s=new n.Variant;s.Parse(e,"property"),i(t,s,parseInt(e.status))})},this.GetSigData=function(e){var i={SigObj:"GetSigData",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(s){var i=new n.Variant;i.Parse(s,"sigData"),e(t,i,parseInt(s.status))})},this.GetSigText=function(e){var i={SigObj:"GetSigText",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,n.sigText,parseInt(n.status))})},this.GetWhen=function(e,i){var a={SigObj:"GetWhen",session:n.session,handle:t.handle,timeZone:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){var n=new Date(parseFloat(e.year),parseFloat(e.month)-1,parseFloat(e.day),parseFloat(e.hour),parseFloat(e.minute),parseFloat(e.second));n.dayOfWeek=parseFloat(e.dayOfWeek),i(t,n,parseInt(e.status))})},this.GetWho=function(e){var i={SigObj:"GetWho",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,n.who,parseInt(n.status))})},this.GetWhy=function(e){var i={SigObj:"GetWhy",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,n.why,parseInt(n.status))})},this.GetWidth=function(e){var i={SigObj:"GetWidth",session:n.session,handle:t.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){e(t,parseInt(n.width),parseInt(n.status))})},this.PutExtraData=function(e,i,a){var o={SigObj:"PutExtraData",session:n.session,handle:t.handle,key:r(e),value:r(i)};JSONreq.getJSON(s+"wacom.js",o,function(e){a(t,parseInt(e.status))})},this.PutInk=function(e,i){var a={SigObj:"PutInk",session:n.session,handle:t.handle,ink:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.PutSigData=function(e,i){var a={SigObj:"PutSigData",session:n.session,handle:t.handle};e.Stringify(a,"sigData"),JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.PutSigText=function(e,i){var a={SigObj:"PutSigText",session:n.session,handle:t.handle,sigText:r(e)};JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.ReadEncodedBitmap=function(e,i){var a={SigObj:"ReadEncodedBitmap",session:n.session,handle:t.handle},o=new n.Variant;o.type=n.VariantType.VARIANT_IMGURL,o.url=e,o.Stringify(a,"bitmapURL"),JSONreq.getJSON(s+"wacom.js",a,function(e){i(t,parseInt(e.status))})},this.RenderBitmap=function(e,i,a,o,c,h,u,l,d,S){var p={SigObj:"RenderBitmap",session:n.session,handle:t.handle,mimetype:r(e),width:r(i),height:r(a),ink_width:r(o),ink_color:r(c),bg_color:r(h),flags:r(u),paddingX:r(l),paddingY:r(d)};JSONreq.getJSON(s+"wacom.js",p,function(i){var a=parseInt(i.status);if(0==a)if(u&n.RBFlags.RenderOutputPicture){var o=new n.Bitmap;o.handle=i.bitmapHandle,o.isBase64=1==i.isBase64,o.image.onload=function(){S(t,o,a)},o.isBase64?o.image.src="data:image/"+e+";base64,"+i.base64:o.image.src=s+i.bitmapHandle+"?session="+n.session}else 1==i.isBase64&&S(t,i.base64,a);else S(t,null,a)})},this.SetProperty=function(e,i,a){var o={SigObj:"SetProperty",session:n.session,handle:t.handle,key:r(e)};i.Stringify(o,"value"),JSONreq.getJSON(s+"wacom.js",o,function(e){a(t,parseInt(e.status))})}},this.DynamicCapture=function(t){var e=this;this.handle=null;var i={DynamicCapture:"Constructor",session:n.session};JSONreq.getJSON(s+"wacom.js",i,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.Capture=function(t,i,a,o,c,h){var u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=window.screenLeft?window.screenLeft:window.screenX,S=window.screenTop?window.screenTop:window.screenY,p={DynamicCapture:"Capture",session:n.session,who:r(i),why:r(a),width:r(u),height:r(l),left:r(d),top:r(S),SigCtlHandle:r(t.handle),handle:e.handle},O=new n.Variant;O.Set(o),O.Stringify(p,"what");var N=new n.Variant;N.Set(c),N.Stringify(p,"key"),JSONreq.getJSON(s+"wacom.js",p,function(t){var s=new n.SigObj;s.handle=t.handle,h(e,s,parseInt(t.status))})},this.GetLicence=function(t){var i={DynamicCapture:"GetLicence",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.licence,parseInt(n.status))})},this.GetProperty=function(t,i){var a={DynamicCapture:"GetProperty",session:n.session,handle:e.handle,key:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){var s=new n.Variant;s.Parse(t,"property"),i(e,s,parseInt(t.status))})},this.PutLicence=function(t,i){var a={DynamicCapture:"PutLicence",session:n.session,handle:e.handle,licence:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.SetProperty=function(t,i,a){var o={DynamicCapture:"SetProperty",session:n.session,handle:e.handle,key:r(t)};i.Stringify(o,"value"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})}},this.SigCtl=function(t){var e=this;this.handle=null,this.type=n.VariantType.VARIANT_SIGCTL;var i={SigCtl:"Constructor",session:n.session};JSONreq.getJSON(s+"wacom.js",i,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.AboutBox=function(t){var i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,h={SigCtl:"AboutBox",session:n.session,width:r(i),height:r(a),left:r(o),top:r(c),handle:e.handle};JSONreq.getJSON(s+"wacom.js",h,function(n){t(e,parseInt(n.status))})},this.GetAppData=function(t,i){var a={SigCtl:"GetAppData",session:n.session,handle:e.handle,key:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){var s=new n.Variant;s.Parse(t,"appData"),i(e,s,parseInt(t.status))})},this.GetInputData=function(t){var i={SigCtl:"GetInputData",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.inputData,parseInt(n.status))})},this.GetLicence=function(t){var i={SigCtl:"GetLicence",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.licence,parseInt(n.status))})},this.GetProperty=function(t,i){var a={SigCtl:"GetProperty",session:n.session,handle:e.handle,key:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){var s=new n.Variant;s.Parse(t,"property"),i(e,s,parseInt(t.status))})},this.GetSignature=function(t){var i={SigCtl:"GetSignature",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(s){var i=new n.SigObj;i.handle=s.signatureHandle,t(e,i,parseInt(s.status))})},this.PutAppData=function(t,i,a){var o={SigCtl:"PutAppData",session:n.session,handle:e.handle,key:r(t)};i.Stringify(o,"val"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})},this.PutInputData=function(t,i){var a={SigCtl:"PutInputData",session:n.session,handle:e.handle,inputData:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutLicence=function(t,i){var a={SigCtl:"PutLicence",session:n.session,handle:e.handle,licence:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutProperties=function(t,i){var a={SigCtl:"PutProperties",session:n.session,handle:e.handle,properties:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutSignature=function(t,i){var a={SigCtl:"PutSignature",session:n.session,handle:e.handle,signatureHandle:r(t.handle)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.SetProperty=function(t,i,a){var o={SigCtl:"SetProperty",session:n.session,handle:e.handle,key:r(t)};i.Stringify(o,"value"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})}},this.InputObj=function(t){var e=this;this.handle=null,this.type=n.VariantType.VARIANT_INPUTOBJ;var i={InputObj:"Constructor",session:n.session};JSONreq.getJSON(s+"wacom.js",i,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.Clear=function(t){var i={InputObj:"Clear",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.GetData=function(t){var i={InputObj:"GetData",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.data,parseInt(n.status))})},this.GetEncryptionType=function(t){var i={InputObj:"GetEncryptionType",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.encryptionType),parseInt(n.status))})},this.GetMaxLength=function(t){var i={InputObj:"GetMaxLength",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.maxLength),parseInt(n.status))})},this.GetMinLength=function(t){var i={InputObj:"GetMinLength",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.minLength),parseInt(n.status))})},this.GetProperty=function(t,i){var a={InputObj:"GetProperty",session:n.session,handle:e.handle,name:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){(new n.Variant).Parse(t,"property"),i(e,t.property,parseInt(t.status))})},this.GetText=function(t){var i={InputObj:"GetText",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.text,parseInt(n.status))})},this.PutMaxLength=function(t,i){var a={InputObj:"PutMaxLength",session:n.session,handle:e.handle,maxLength:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutMinLength=function(t,i){var a={InputObj:"PutMinLength",session:n.session,handle:e.handle,minLength:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.SetEncryption=function(t,i,a){var o={InputObj:"SetEncryption",session:n.session,handle:e.handle,type:r(t)};i.Stringify(o,"key"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})},this.SetProperty=function(t,i,a){var o={InputObj:"SetProperty",session:n.session,handle:e.handle,name:r(t),value:r(i)};JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})}},this.ObjectOptions=function(){var t=this;this.type=n.VariantType.VARIANT_OBJECTOPTIONS,this.AddOption=function(e,n){t[e]=n}},this.Variant=function(){var t=this;this.type=n.VariantType.VARIANT_EMPTY,this.Parse=function(e,s){var i=parseInt(e[s+".type"]);switch(i){case n.VariantType.VARIANT_TEXT:t.type=i,t.text=e[s+".text"];break;case n.VariantType.VARIANT_NUM:t.type=i,t.num=parseFloat(e[s+".num"]);break;case n.VariantType.VARIANT_OBJECTOPTIONS:t.type=i;break;case n.VariantType.VARIANT_SIGOBJ:case n.VariantType.VARIANT_SIGCTL:case n.VariantType.VARIANT_INPUTOBJ:case n.VariantType.VARIANT_HASH:case n.VariantType.VARIANT_KEY:case n.VariantType.VARIANT_DYNCAP:case n.VariantType.VARIANT_WIZCTL:t.type=i,t.handle=e[s+".handle"];break;case n.VariantType.VARIANT_BASE64:t.type=i,t.base64=e[s+".base64"];break;case n.VariantType.VARIANT_IMGURL:t.type=i,t.url=e[s+".url"];break;case n.VariantType.VARIANT_FONT:t.type=i,t.fontName=e[s+".fontName"],t.fontSize=e[s+".fontSize"],t.sWeight=e[s+".sWeight"],t.sCharset=e[s+".sCharset"],t.fItalic=e[s+".fItalic"],t.fUnderline=e[s+".fUnderline"],t.fStrikethrough=e[s+".fStrikethrough"];break;case n.VariantType.VARIANT_EMPTY:default:t.type=n.VariantType.VARIANT_EMPTY}},this.Set=function(e){if("string"==typeof e)t.type=n.VariantType.VARIANT_TEXT,t.text=e;else if("number"==typeof e)t.type=n.VariantType.VARIANT_NUM,t.num=e;else if(null!=e&&"object"==typeof e&&void 0!==e.type&&null!=e.type)switch(e.type){case n.VariantType.VARIANT_OBJECTOPTIONS:for(o in t.type=n.VariantType.VARIANT_OBJECTOPTIONS,e)"type"!=o&&("string"==typeof e[o]?(t[o]=e[o],t[o+".type"]=n.ObjectOptionType.OBJECTOPTION_STRING):"number"==typeof e[o]?(t[o]=e[o]>0?Math.floor(e[o]):Math.ceil(e[o]),t[o+".type"]=n.ObjectOptionType.OBJECTOPTION_INT):"boolean"==typeof e[o]&&(t[o]=1==e[o]?1:0,t[o+".type"]=n.ObjectOptionType.OBJECTOPTION_BOOL));break;case n.VariantType.VARIANT_SIGOBJ:case n.VariantType.VARIANT_SIGCTL:case n.VariantType.VARIANT_INPUTOBJ:case n.VariantType.VARIANT_HASH:case n.VariantType.VARIANT_KEY:case n.VariantType.VARIANT_DYNCAP:case n.VariantType.VARIANT_WIZCTL:t.type=e.type,t.handle=e.handle;break;case n.VariantType.VARIANT_IMGURL:t.type=n.VariantType.VARIANT_IMGURL,t.url=e.url;break;case n.VariantType.VARIANT_BASE64:t.type=n.VariantType.VARIANT_BASE64,t.base64=e.base64;break;case n.VariantType.VARIANT_FONT:t.type=n.VariantType.VARIANT_FONT,t.fontName=e.fontName,t.fontSize=e.fontSize,t.sWeight=e.sWeight,t.sCharset=e.sCharset,t.fItalic=e.fItalic,t.fUnderline=e.fUnderline,t.fStrikethrough=e.fStrikethrough;break;case n.VariantType.VARIANT_EMPTY:default:t.type=n.VariantType.VARIANT_EMPTY}},this.Stringify=function(e,n){for(var s in t)"string"!=typeof s||"function"==typeof t[s]||"symbol"==typeof t[s]||"object"!=typeof t[s]&&"string"!=typeof t[s]&&"number"!=typeof t[s]||(e[n+"."+s]=t[s.toString()])}},this.WizCtl=function(t){var e=this;this.handle=null;var i,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=window.screenLeft?window.screenLeft:window.screenX,h=window.screenTop?window.screenTop:window.screenY,u={WizCtl:"Constructor",session:n.session,width:a,height:o,left:c,top:h};JSONreq.getJSON(s+"wacom.js",u,function(n){e.handle=n.handle,t(e,parseInt(n.status))}),this.AddObject=function(t,i,a,o,c,h,u){var l={WizCtl:"AddObject",session:n.session,handle:e.handle,objType:r(t),id:r(i)};a.Stringify(l,"X"),o.Stringify(l,"Y"),c.Stringify(l,"objData"),h.Stringify(l,"options"),JSONreq.getJSON(s+"wacom.js",l,function(t){u(e,parseInt(t.status))})},this.AddPrimitive=function(t,i,a,o,c,h,u,l){var d={WizCtl:"AddPrimitive",session:n.session,handle:e.handle,primType:r(t)},S=new n.Variant,p=new n.Variant,O=new n.Variant,N=new n.Variant;S.Set(i),p.Set(a),O.Set(o),N.Set(c),S.Stringify(d,"X1"),p.Stringify(d,"Y1"),O.Stringify(d,"X2"),N.Stringify(d,"Y2"),h.Stringify(d,"primData"),u.Stringify(d,"options"),JSONreq.getJSON(s+"wacom.js",d,function(t){l(e,parseInt(t.status))})},this.Close=function(t){var i={WizCtl:"Close",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.Display=function(t){var i={WizCtl:"Display",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.FireClick=function(t,i){var a={WizCtl:"FireClick",session:n.session,handle:e.handle,fireClickId:t};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.GetBackColor=function(t){var i={WizCtl:"GetBackColor",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.backColor),parseInt(n.status))})},this.GetBorderColor=function(t){var i={WizCtl:"GetBorderColor",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.borderColor),parseInt(n.status))})},this.GetBorderStyle=function(t){var i={WizCtl:"GetBorderStyle",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.borderStyle),parseInt(n.status))})},this.GetBorderVisible=function(t){var i={WizCtl:"GetBorderVisible",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,Boolean(1==parseInt(n.borderVisible)),parseInt(n.status))})},this.GetBorderWidth=function(t){var i={WizCtl:"GetBorderWidth",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.borderWidth),parseInt(n.status))})},this.GetEnableWizardDisplay=function(t){var i={WizCtl:"GetEnableWizardDisplay",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,Boolean(1==parseInt(n.enableWD)),parseInt(n.status))})},this.GetFont=function(t){var i={WizCtl:"GetFont",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(s){var i=new n.Variant;i.Parse(s,"font"),t(e,i,parseInt(s.status))})},this.GetInkingPad=function(t){var i={WizCtl:"GetInkingPad",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,Boolean(1==parseInt(n.inkingPad)),parseInt(n.status))})},this.GetLicence=function(t){var i={WizCtl:"GetLicence",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,n.licence,parseInt(n.status))})},this.GetObjectState=function(t,i){var a={WizCtl:"GetObjectState",session:n.session,handle:e.handle,objectId:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){var s=new n.Variant;s.Parse(t,"objState"),i(e,s,parseInt(t.status))})},this.GetPadHeight=function(t){var i={WizCtl:"GetPadHeight",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseFloat(n.height),parseInt(n.status))})},this.GetPadWidth=function(t){var i={WizCtl:"GetPadWidth",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseFloat(n.width),parseInt(n.status))})},this.GetProperty=function(t,i){var a={WizCtl:"GetProperty",session:n.session,handle:e.handle,key:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){var s=new n.Variant;s.Parse(t,"property"),i(e,s,parseInt(t.status))})},this.GetVisibleWindow=function(t){var i={WizCtl:"GetVisibleWindow",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,Boolean(1==parseInt(n.visible)),parseInt(n.status))})},this.GetZoom=function(t){var i={WizCtl:"GetZoom",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseFloat(n.zoom),parseInt(n.status))})},this.PadConnect=function(t){var i={WizCtl:"PadConnect",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,Boolean(1==parseInt(n.padConnect)),parseInt(n.status))})},this.PadDisconnect=function(t){var i={WizCtl:"PadDisconnect",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.PutBackColor=function(t,i){var a={WizCtl:"PutBackColor",session:n.session,handle:e.handle,backColor:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutBorderColor=function(t,i){var a={WizCtl:"PutBorderColor",session:n.session,handle:e.handle,borderColor:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutBorderStyle=function(t,i){var a={WizCtl:"PutBorderStyle",session:n.session,handle:e.handle,borderStyle:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutBorderVisible=function(t,i){var a={WizCtl:"PutBorderVisible",session:n.session,handle:e.handle,borderVisible:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutBorderWidth=function(t,i){var a={WizCtl:"PutBorderWidth",session:n.session,handle:e.handle,borderWidth:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutEnableWizardDisplay=function(t,i){var a={WizCtl:"PutEnableWizardDisplay",session:n.session,handle:e.handle,enableWD:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutFont=function(t,i){var a={WizCtl:"PutFont",session:n.session,handle:e.handle};t.Stringify(a,"font"),JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutLicence=function(t,i){var a={WizCtl:"PutLicence",session:n.session,handle:e.handle,licence:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutPadHeight=function(t,i){var a={WizCtl:"PutPadHeight",session:n.session,handle:e.handle,height:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutPadWidth=function(t,i){var a={WizCtl:"PutPadWidth",session:n.session,handle:e.handle,width:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutProperties=function(t,i){var a={WizCtl:"PutProperties",session:n.session,handle:e.handle,properties:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutRefFont=function(t,i){var a={WizCtl:"PutRefFont",session:n.session,handle:e.handle};t.Stringify(a,"font"),JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutVisibleWindow=function(t,i){var a={WizCtl:"PutVisibleWindow",session:n.session,handle:e.handle,visible:Number(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.PutZoom=function(t,i){var a={WizCtl:"PutZoom",session:n.session,handle:e.handle,zoom:r(t)};JSONreq.getJSON(s+"wacom.js",a,function(t){i(e,parseInt(t.status))})},this.Reset=function(t){var i={WizCtl:"Reset",session:n.session,handle:e.handle};JSONreq.getJSON(s+"wacom.js",i,function(n){t(e,parseInt(n.status))})},this.SetProperty=function(t,i,a){var o={WizCtl:"SetProperty",session:n.session,handle:e.handle,key:t};i.Stringify(o,"value"),JSONreq.getJSON(s+"wacom.js",o,function(t){a(e,parseInt(t.status))})},this.SetEventHandler=function(t){var a={WizCtl:"SetEventHandler",session:n.session,handle:e.handle};i=t,JSONreq.getJSON(s+"wacom.js",a,function t(a){var o={WizCtl:"UpdateEventHandler",session:n.session,handle:e.handle};if(0==parseInt(a.status))JSONreq.getJSON(s+"wacom.js",o,t);else if(void 0===a.status)return;setTimeout(function(){i(e.handle,a["event-id"],parseInt(a["event-type"]),parseInt(a.status))},0)})}}}