var vClock=function(){var t,o=$("#col-main"),e=$("#pnl-main"),i=$("#lbl-title"),n=$("#pnl-time"),l=$("#lbl-time"),c=$("#lbl-noon"),r=$("#lbl-date"),a=$("#pnl-tools"),s=$("#btn-font-minus"),d=$("#btn-font-plus"),h=$("#pnl-neon"),f=!1,g=!1,u=!1,p=$("#row-clocks"),m=$("#edt-title"),k=$("#edt-country"),C=$("#edt-time-zone"),v=0;void 0!=e.data("utc")&&(v=parseInt(e.data("utc"),10)-Math.floor((new Date).getTime()/1e3));var T=-1,b=-1,w=-1,S="",x=!1,z="";function y(){isEmbed||(z="")!=location.hash.substring(1)&&location.replace("#"+z)}function I(){if(""==(z=location.hash.substring(1)))return!1;for(var t=z.split("&"),o=0;o<t.length;o++){var e=t[o].split("=");processURIParam(e[0],e[1])}return!0}function F(){var t="";$(".clock-body").each(function(){var o=$(this).data("country"),e=$(this).data("tz"),i=$(this).parent().find(".title").text();i!=D(o,e,!0)&&(t+="title="+i+"\n"),t+=o+"="+e+"\n"}),configC.clockPanels=t,configC.save("clockPanels")}var E=!1;function M(){if(!E){E=!0;var t="";if("undefined"!=typeof arrTZCountries){for(var o=0;o<arrTZCountries.length;o++)t+='<option value="'+arrTZCountries[o][0]+'">'+arrTZCountries[o][1]+"</option>";t+='<option value="" disabled="disabled">─────────</option>'}$.each(tzCountries,function(o,e){t+="<option value='"+o+"'>"+e.name+"</option>"}),k.html(t),void 0!==tzCountries[langC.id.toUpperCase()]&&k.val(langC.id.toUpperCase())}}function _(t){if("undefined"==typeof arrTZCountries)return"";for(var o=0;o<arrTZCountries.length;o++)if(arrTZCountries[o][0]==t)return arrTZCountries[o][1];return""}function W(t,o){return t+("en"==langC.id&&"US"==o||langC.id.toUpperCase()==o?"":langC.commaSign+_(o))}function N(t,o){return(t+(langC.id.toUpperCase()!=o?"-"+_(o):"")).replace(/,/g,"").replace(/ /g,"-").toLowerCase()}function D(t,o,e){var i="";if("undefined"!=typeof arrWorldclock)for(var n=0;n<arrWorldclock.length;n++)if(arrWorldclock[n][1]==t&&arrWorldclock[n][2]==o){i=e?W(arrWorldclock[n][0],arrWorldclock[n][1]):arrWorldclock[n][0];break}if(""==i){var l=o.split("/");i=l[l.length-1].replace(/_/g," ")}return i}function O(t,o,e){var i="",n=D(o,e,!0);if("undefined"!=typeof arrWorldclock)for(var l=0;l<arrWorldclock.length;l++)if(arrWorldclock[l][1]==o&&arrWorldclock[l][2]==e){var c=W(arrWorldclock[l][0],arrWorldclock[l][1]);if(c==t){i=N(arrWorldclock[l][0],arrWorldclock[l][1])+"/",n=c;break}}if(""==i){var r=e.split("/");i=r[r.length-1]+"_"+o+"/"}return n!=t&&(isPlainURIParam(t)?i+=t.replace(/ /g,"+")+"/":i+="?title="+encodeURIComponent(t).replace(/%20/g,"+")),i}function Z(o){t=o.parent().parent().parent().parent().parent().parent()}function U(o,i,n){var l=$('<div class="col-sm-4 col-md-3"><div class="panel panel-default panel-heading-fullwidth">      <div class="panel-heading colored">'+$("#pnl-clock-tools").html()+'<a href="#" class="colored ext-link"><span class="title text-ellipsis">'+encodeTitle(o)+'</span></a>      </div>      <div class="panel-body clock-body" data-country="'+i+'" data-tz="'+n+'">      <div class="colored digit text-nowrap text-center" style="font-size: 30px"></div><div class="colored text-center" style="font-size: 16px"></div>      </div></div></div>');l.find(".ext-link").attr("href",O(o,i,n)),l.insertBefore("#col-add-clock"),t=l.children().first(),setColors(),$(".pm-edit").off("click").click(function(){g||(Z($(this)),$("#lbl-add-clock").hide(),$("#lbl-edit-clock").show(),u=!1,M(),k.val(t.find(".clock-body").data("country")),k.change(),C.val(t.find(".clock-body").data("tz")),m.val(t.find(".title").text()),$("#form-edit").modal("show"))}),$(".pm-move-top").off("click").click(function(){Z($(this)),setSelectedColor(t),$("html, body").scrollTop()-(e.height()+30)>0&&$("html, body").animate({scrollTop:e.height()+30},"fast"),setTimeout(function(){var o=t.parent();o.insertBefore(o.siblings().first()),setTimeout(function(){setDefaultColor(t)},400),F()},100)}),$(".pm-move-up").off("click").click(function(){Z($(this)),setSelectedColor(t),setTimeout(function(){var o=t.parent();o.insertBefore(o.prev()),setTimeout(function(){setDefaultColor(t)},400),F()},100)}),$(".pm-move-down").off("click").click(function(){Z($(this)),setSelectedColor(t),setTimeout(function(){var o=t.parent();o.insertAfter(o.next()),setTimeout(function(){setDefaultColor(t)},400),F()},100)}),$(".pm-delete").off("click").click(function(){Z($(this)),t.css("background-color","#FF8585"),t.find(".colored").css("color","#fff"),t.parent().fadeOut(400,function(){$(this).remove(),setTimeout(q,0),F()})})}k.change(function(){for(var t,o,e,i=moment().clone().tz("UTC"),n=k.val(),l=tzCountries[n].zones,c="",r=0;r<l.length;r++)t=l[r],e="(UTC "+((o=moment.tz.zone(t).parse(i))<=0?"+":"-"),o=Math.abs(o),c+="<option value='"+t+"'>"+(e+=intToStrTwo(Math.floor(o/60))+":"+intToStrTwo(o%60)+") ")+D(n,t,!1)+"</option>";C.html(c),C.change()}),C.change(function(){m.val(D(k.val(),C.val(),!0))}),$("#btn-add-clock").click(function(){g||(t=void 0,$("#lbl-add-clock").show(),$("#lbl-edit-clock").hide(),u=!0,M(),k.change(),$("#form-edit").modal("show"))}),$("#btn-ok").click(function(){var o=m.val(),e=k.val(),i=C.val();""==o.trim()&&(o=D(e,i,!0)),u?(U(o,e,i),setDigitFontNames(),fadeHighlight(t,400)):(t.find(".title").text(o),t.find(".clock-body").data("country",e),t.find(".clock-body").data("tz",i),t.find(".ext-link").attr("href",O(o,e,i))),F(),f=!0,J(!0)}),$("#form-edit").on("show.bs.modal",function(){cancelFullScreen(),g=!0,setSelectedColor(t)}).on("hide.bs.modal",function(){setTimeout(function(){g=!1},100),u||setDefaultColor(t)});var L=0,A=0,H=parseInt(l.css("font-size"),10);function B(){setDigitFontNames(),P(0)}function P(t){H+=t,l.css("font-size",H+"px");var o=getSizeDT(H);c.css("font-size",Math.round(H/(configC.themeDigitalFont&&"AM"==langC.am?1.3:3))+"px"),L=Math.round(l.height()/4),A=configC.themeDigitalFont?Math.round(l.height()/6):0,""!=i.text()&&i.css("font-size",Math.max(o,MIN_TITLE_FONT_SIZE)+"px"),configC.clockDateVisible&&r.css("font-size",Math.max(o,MIN_DATE_FONT_SIZE)+"px")}function V(){return l.height()+(""!=i.text()?i.height()+L+A:A)+(configC.clockDateVisible?r.height()+L+A:A)+L}function G(){return l.width()+(configC.clock12hour?4*c.width():l.height())}var R,Y=0,j=5;function q(){if(x&&(!isEmbed||0!=$(window).height())){1==a.length&&(Y=o.position().top-15,a.css("margin",Y+"px"),j=a.height());var t=j+Y,f=t+Y+(""!=i.text()?MIN_LABEL_HEIGHT:0)+(configC.clockDateVisible?MIN_LABEL_HEIGHT:0)+MIN_TIME_HEIGHT,g=FONT_SIZES[configC.clockFontSizeId];if(p.children().length>1?($("#pnl-add-clock").css("height",p.find(".panel-default").first().height()+"px"),$("#pnl-add-clock-center").css("height","20%")):($("#pnl-add-clock").css("height",4*$("#btn-add-clock").height()+"px"),$("#pnl-add-clock-center").css("height","45%")),e.css("height",Math.max(f,$(window).height()-e.offset().top-p.children().first().height()-(isEmbed||0===h.length?0:90)-Math.max(MIN_BOTTOM_MARGIN,o.position().top))+"px"),isEmbed&&($(window).width()<200||$(window).height()<e.height())&&(e.css("height",$(window).height()),e.height()<80&&(configC.clockDateVisible=!1,r.hide(),i.html(""))),isEmbed&&($(window).width()<400||$(window).height()<300)&&($(".digit-text").removeClass("digit-text").removeClass("font-digit-text"),setDigitFontNames()),""!=l.html()){for(var u,m,k=e.height()-t,C=e.width();H<g&&V()<k&&G()<C;)P(1);for(;!(u=V(),m=G(),H<=g&&u<=k&&m<=C||(P(Math.round(Math.min((k-u)/4,(C-m)/20,-1))),H<MIN_FONT_SIZE)););}!function(){var t=H<=FONT_SIZES[0],o=configC.clockFontSizeId==FONT_SIZE_LEN||H<FONT_SIZES[configC.clockFontSizeId];t&&o?(s.hide(),d.hide()):(t?s.addClass("disabled"):s.removeClass("disabled"),s.show(),o?d.addClass("disabled"):d.removeClass("disabled"),d.show())}(),n.css("width",l.width()+c.width()+"px"),n.css("height",l.height()+"px"),n.css("left",(langC.rtl?-1:1)*Math.round((e.width()-l.width())/2)-(langC.rtlTime&&configC.clock12hour?c.width():0)+"px");var v=Math.round((e.height()-n.height())/2);e.height()<V()+(""==i.text()?L:0)?n.css("top",Y+(""!=i.text()?i.height()+L+A:A)+Math.round((e.height()-V())/2-l.position().top)+"px"):n.css("top",v-l.position().top+"px"),i.css("width",e.width()+"px"),i.css("top",n.position().top+l.position().top-i.height()-A+"px");var T=n.position().top+l.position().top+l.height()+A;r.css("width",e.width()+"px"),r.css("top",T+"px")}}function J(t){var o=moment();if(!0===t)clearTimeout(R),T=b=-1,R=setTimeout(J,200);else{if(o.milliseconds()<350||o.milliseconds()>650)return void(R=setTimeout(J,50));R=setTimeout(J,1e3)}0!=v&&o.add(v,"seconds"),""!=S&&(o=o.tz(S));var e=o.hours(),i=o.minutes(),n=o.seconds();configC.clock12hour&&(langC.rtlTime?c.html((e<12?langC.am:langC.pm)+"&nbsp;"):c.html("&nbsp;"+(e<12?langC.am:langC.pm)),0==(e%=12)&&(e=12)),l.html(intToStrHours(e)+":"+intToStrTwo(i)+":"+intToStrTwo(n)),b!=e&&(b=e,q()),w!=i&&(f=!0,w=i),$(".clock-body").each(function(t,e){var i=o.clone().tz($(e).data("tz")),n=i.hours();if(configC.clock12hour){var l=n<12?langC.am:langC.pm;langC.rtlTime?l+="&nbsp;":l="&nbsp;"+l,configC.themeDigitalFont&&"AM"==langC.am||(l="<span style='font-size: 18px;"+(configC.themeDigitalFont?" position: relative; top: -2px;":"")+"'>"+l+"</span>"),0==(n%=12)&&(n=12)}var c=intToStrHours(n)+":"+intToStrTwo(i.minutes())+":"+intToStrTwo(i.seconds());configC.clock12hour&&(langC.rtlTime?c=l+c:c+=l),$(e).children().first().html(c),f&&$(e).children().last().html(K(o,i))}),f&&$("#lbl-offset").html(K(moment(),o)),f=!1,o.date()!=T&&(T=o.date(),r.html(getDateTextByParts(o.day(),o.date(),o.month(),o.year(),configC.themeDigitalFont&&langC.isDigitalLabel,!0)))}function K(t,o){var e=o.utcOffset()-t.utcOffset(),i=e>=0?"+":"-",n=(e=Math.abs(e))%60;return i+=Math.floor(e/60)+(0!=n?":"+intToStrTwo(e%60):langC.isAsian?langC.hour:" "+langC.hour[0]),(t.dayOfYear()==o.dayOfYear()?langC.today:o.year()<t.year()||o.dayOfYear()<t.dayOfYear()?langC.yesterday:langC.tomorrow)+langC.commaSign+i}return{init:function(){$("noscript").remove(),configC.restoreClock(),configC.clock12hour||c.hide(),configC.clockDateVisible||r.hide(),langC.rtlTime&&c.insertBefore(l),$(window).resize(q),window.refreshSettings=function(){c.toggle(configC.clock12hour),r.toggle(configC.clockDateVisible),x&&(B(),J(!0))},s.click(function(){for(hideTooltips();configC.clockFontSizeId>0&&(configC.clockFontSizeId--,!(H>FONT_SIZES[configC.clockFontSizeId])););configC.save("clockFontSizeId"),q()}),d.click(function(){hideTooltips(),configC.clockFontSizeId<FONT_SIZE_LEN&&H==FONT_SIZES[configC.clockFontSizeId]&&configC.clockFontSizeId++,configC.save("clockFontSizeId"),q()}),$(document).on("keydown",function(t){!configC.themeFullScreen||g||"Escape"!==t.key&&"Esc"!==t.key||$("#btn-full-screen-exit").trigger("click"),g&&"Enter"===t.key&&$("#btn-ok").trigger("click",t)}),$(window).bind("hashchange",function(){isEmbed||setShareEdit(),z!=location.hash.substring(1)&&I()&&y()}),I()&&y(),function(){var t;if(""==(S=e.data("langtz").toLowerCase())){if(i.css("display","block"),""==configC.clockPanels){if("undefined"!=typeof arrWorldclock)for(t=0;t<arrWorldclock.length;t++)arrWorldclock[t][3]&&U(W(arrWorldclock[t][0],arrWorldclock[t][1]),arrWorldclock[t][1],arrWorldclock[t][2])}else{var o=configC.clockPanels.split("\n"),n="";for(t=0;t<o.length;t++){var l=o[t];if("title="==l.substr(0,6))n=l.substr(6);else if("="==l.charAt(2)){var c=l.substr(0,2),r=l.substr(3);U(""==n?D(c,r,!0):n,c,r),n=""}}}$("#pnl-add-clock").show()}else{var a=!1;if("undefined"!=typeof arrWorldclock)for(t=0;t<arrWorldclock.length;t++)if(N(arrWorldclock[t][0],arrWorldclock[t][1])==S){S=arrWorldclock[t][2],""==i.text()&&i.text(W(arrWorldclock[t][0],arrWorldclock[t][1])),a=!0;break}if(!a&&"_"==S.charAt(S.length-3)){var s=S.slice(-2).toUpperCase(),d=tzCountries[s];if(void 0!=d){var h=d.zones,f=S.substr(0,S.length-3);for(t=0;t<h.length;t++){var g=h[t].split("/");if(g[g.length-1].toLowerCase()==f){S=h[t];var u=_(s);""==e.data("title")&&i.text(g[g.length-1].replace(/_/g," ")+(""!=u?langC.commaSign+u:"")),a=!0;break}}}}if(a||(S=e.data("tz")),""!=S){var p=moment.tz.zone(S).parse(moment().clone().tz("UTC")),m="(UTC/GMT "+(p<=0?"+":"-");p=Math.abs(p),$("#lbl-tz-name").html(m+intToStrTwo(Math.floor(p/60))+":"+intToStrTwo(p%60)+") "+S)}i.css("display","block")}$("td:nth-child(2)",".table-lr").remove(),$("#pnl-description,#pnl-share,#pnl-help").show()}(),isEmbed||setShareEdit(),$("#pnl-time").css("text-align",""),o.show(),B(),J(!0),function(){var t=configC.clockFontSizeId;for(H=FONT_SIZES[t],l.css("font-size",H+"px");t>0&&(V()>$(window).height()||G()>e.width());)t--,H=FONT_SIZES[t],l.css("font-size",H+"px");P(0)}(),x=!0,q(),setTimeout(q,100),setTimeout(q,1e3),setInterval(function(){g||"block"!==$("#form-embed").css("display")&&($(".dropdown.open").length||window.location.reload(!0))},288e5)}}}();